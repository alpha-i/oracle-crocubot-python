machine:
  post:
#    - sudo apt-get update
#    - sudo apt-get install gcc libgsl0-dev
    - wget https://repo.continuum.io/miniconda/Miniconda3-4.2.11-Linux-x86_64.sh -O ~/miniconda.sh
    - bash ~/miniconda.sh -b -p $HOME/miniconda
    - echo 'PATH="$HOME/miniconda/bin:$PATH"' >> .bashrc

dependencies:
  pre:
    - conda install --yes pip
    - pip install --upgrade pip
    - pip install setuptools
  override:
    - pip install -r dev-requirements.txt

test:
  override:
#    - flake8 ./
#    - PYTHONPATH=. pytest --cov=alphai_crocubot_oracle --cov-report html:$CIRCLE_ARTIFACTS tests/
#    - python setup.py develop
    - conda create -y -n integration-test-env python=3.5
    - source activate integration-test-env;conda install -y -c Quantopian zipline=1.1.1
    - git clone git@github.com:alpha-i/tool-integration-test-python.git ../tool-integration-test-python
    - cd ../tool-integration-test-python;git checkout feature/autmation_of_test_circleci;pip install -r requirements.txt
    - conda env list
    - pip freeze
    - python ../tool-integration-test-python/setup.py install
    - python ../tool-integration-test-python/integration_test/create_and_ingest_data.py